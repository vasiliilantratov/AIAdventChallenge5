# Командный ассистент - Документация

## Обзор

Командный ассистент - это интегрированное решение для управления командой разработчиков, объединяющее:
- Управление задачами (Task Management)
- Поиск по документации проекта (RAG)
- Работу с репозиторием (MCP)
- Интеллектуальные рекомендации от LLM

## Архитектура

### Компоненты

1. **TaskManagerMcp** (`src/main/kotlin/mcp/TaskManagerMcp.kt`)
   - Управление задачами через JSON файл
   - CRUD операции для задач
   - Фильтрация по приоритету и статусу
   - Поиск по ключевым словам
   - Статистика по задачам

2. **Task Model** (`src/main/kotlin/model/Task.kt`)
   - Модели данных: Task, TaskPriority, TaskStatus
   - Сериализация в JSON
   - Поддержка тегов, дедлайнов, исполнителей

3. **TeamCommand** (`src/main/kotlin/cli/TeamCommand.kt`)
   - CLI команда для работы с командным ассистентом
   - LLM-роутинг для выбора инструментов
   - Интеграция RAG, MCP и Task Manager
   - Форматированный вывод результатов

4. **tasks.json** (создается автоматически)
   - Хранилище задач в JSON формате
   - Инициализируется с примерами при первом запуске

## Возможности

### Управление задачами

- **Просмотр задач**: фильтрация по приоритету, статусу
- **Создание задач**: автоматическое извлечение информации из естественного языка
- **Статистика**: распределение по статусам и приоритетам
- **Поиск**: по названию, описанию, тегам, исполнителям

### Приоритеты

- **CRITICAL**: критичные задачи, требуют немедленного решения
- **HIGH**: высокий приоритет
- **MEDIUM**: средний приоритет
- **LOW**: низкий приоритет

### Статусы

- **TODO**: не начата
- **IN_PROGRESS**: в работе
- **BLOCKED**: заблокирована (требует внимания)
- **DONE**: завершена

### LLM-роутинг инструментов

LLM анализирует вопрос пользователя и выбирает необходимые инструменты:

1. **TASK_MANAGEMENT**: работа с задачами
   - LIST: просмотр задач
   - CREATE: создание задачи
   - STATS: статистика
   - RECOMMEND: рекомендации по приоритизации

2. **RAG**: поиск по документации проекта

3. **GIT_INFO**: информация о ветке и статусе репозитория

4. **CODE_SEARCH**: поиск по исходному коду

Инструменты могут использоваться по отдельности или в комбинации для комплексных вопросов.

### Умные рекомендации

Ассистент анализирует:
- Критичные задачи (CRITICAL priority)
- Заблокированные задачи (BLOCKED status)
- Задачи с приближающимся дедлайном
- Распределение нагрузки по команде

И предлагает:
- Оптимальную последовательность выполнения
- Способы разблокировки задач
- Перераспределение ресурсов

## Примеры использования

### Просмотр задач по приоритету
```bash
./gradlew run --args='team "покажи задачи с приоритетом high"'
```

### Просмотр заблокированных задач
```bash
./gradlew run --args='team "есть ли блокирующие задачи?"'
```

### Рекомендации по приоритизации
```bash
./gradlew run --args='team "что делать в первую очередь?"'
```

### Статус проекта
```bash
./gradlew run --args='team "какой статус у проекта?"'
```

### Создание задачи
```bash
./gradlew run --args='team "создай задачу: добавить мониторинг производительности"'
```

### Комплексный анализ
```bash
./gradlew run --args='team "покажи критичные задачи и предложи решение"'
```

## Формат данных

### Структура Task в JSON

```json
{
  "id": "uuid",
  "title": "Название задачи",
  "description": "Описание задачи",
  "priority": "HIGH",
  "status": "IN_PROGRESS",
  "assignee": "Имя исполнителя",
  "tags": ["backend", "security"],
  "createdAt": "2026-01-10T09:00:00",
  "updatedAt": "2026-01-14T15:30:00",
  "dueDate": "2026-01-20T23:59:59"
}
```

## Интеграция с существующими компонентами

### RAG (Retrieval-Augmented Generation)
- Используется для поиска информации в документации
- Помогает отвечать на вопросы о технических деталях
- Автоматически индексирует README, docs, API specs

### MCP (Model Context Protocol)
- Безопасный доступ к git-командам
- Поиск по исходному коду через ripgrep
- Чтение файлов с контекстом

### LLM (Ollama)
- Анализ вопросов и выбор инструментов
- Извлечение информации о задачах из естественного языка
- Генерация рекомендаций и ответов

## Расширяемость

Система легко расширяется:

1. **Новые действия с задачами**: добавить в TeamToolsDecision и обработчик
2. **Новые фильтры**: расширить TaskManagerMcp
3. **Интеграция с внешними системами**: заменить JSON на API (Jira, GitHub Issues, etc.)
4. **Дополнительные инструменты**: добавить в LLM-роутинг

## Производительность

- Быстрая работа с JSON файлом (in-memory операции)
- Ленивая инициализация компонентов
- Кэширование индекса документации
- Параллельное выполнение независимых операций

## Безопасность

- Валидация путей в MCP (защита от path traversal)
- Ограниченный набор git-команд (только чтение)
- Изоляция данных задач (локальный JSON файл)

## Заключение

Командный ассистент предоставляет единую точку входа для:
- Управления задачами команды
- Поиска информации о проекте
- Получения рекомендаций по планированию

Интеллектуальная система роутинга позволяет задавать вопросы на естественном языке, 
а LLM самостоятельно определяет, какие источники данных необходимы для ответа.
