# Консольный чат с Hugging Face моделями (OpenAI-совместимый протокол)

Kotlin-приложение для диалога с тремя предустановленными моделями через OpenAI-совместимый endpoint. Работает в терминале, выводит статистику токенов после каждого ответа.

## Требования

- Java 21+
- Доступный OpenAI-совместимый endpoint (например, HF Inference Endpoint)
- Переменные окружения `OPENAI_API_KEY` и `OPENAI_BASE_URL`

## Настройка окружения

Обязательные переменные:

- `OPENAI_API_KEY` — Bearer-токен для авторизации.
- `OPENAI_BASE_URL` — базовый URL без завершающего слеша, например `https://api.example.com/v1`.

Приложение завершится с ошибкой, если переменные не заданы.

## Запуск

```bash
./gradlew run
```

## Доступные модели

1. `[1] DeepSeek-R1 (deepseek-ai/DeepSeek-R1:novita)`
2. `[2] X-ALMA-13B (haoranxu/X-ALMA-13B-Pretrain:featherless-ai)`
3. `[3] Qwen2.5-0.5B (benfielding/Qwen2.5-0.5B-Instruct-Gensyn-Swarm-alert_arctic_dinosaur:featherless-ai)`

В запросе используется исходная строка `model`.

## Команды в чате

- `/exit` — выйти.
- `/help` — показать справку.
- `/clear` — очистить историю сообщений (сохраняет счётчики токенов).
- `/model` — сменить модель (сбрасывает историю, сохраняет счётчики токенов).

## Вывод токенов

После каждого ответа показывается статистика:

- Токены за запрос: `prompt_tokens`, `completion_tokens`, `total_tokens`.
- Суммарно за сессию: накопительные счётчики по тем же полям.
Если `usage` отсутствует в ответе, выводится сообщение о недоступности данных.

## Архитектура

- `DomainModels.kt` — модели API и перечень поддерживаемых моделей.
- `OllamaChatClient.kt` — HTTP-клиент (`ChatApiClient`) для отправки запросов.
- `AiDialogService.kt` — сессия чата (`ChatSession`) с подсчётом токенов.
- `Main.kt` — консольный UI и обработка команд.
