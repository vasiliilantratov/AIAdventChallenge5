# FAQ: Индексация документов в системе Соната-2041

## Вопрос: Как индексировать документы?

**Ответ:**
Для индексации документов используйте команду:

```bash
./gradlew run --args="index /путь/к/документам --chunk-size 512 --overlap 50"
```

Параметры:
- `--chunk-size` - размер чанка в символах (по умолчанию: 512)
- `--overlap` - размер перекрытия между чанками (по умолчанию: 50)
- `--ollama-url` - URL сервера Ollama (по умолчанию: http://localhost:11434)
- `--db-path` - путь к базе данных SQLite (по умолчанию: ./index.db)

## Вопрос: Какие форматы файлов поддерживаются?

**Ответ:**
Система Соната-2041 поддерживает следующие форматы:

**Текстовые документы:**
- Markdown: `.md`
- Текст: `.txt`

**Код:**
- Kotlin: `.kt`
- Java: `.java`
- JavaScript/TypeScript: `.js`, `.ts`, `.jsx`, `.tsx`
- Python: `.py`
- Rust: `.rs`
- Go: `.go`
- C/C++: `.cpp`, `.c`, `.h`, `.hpp`
- C#: `.cs`
- Ruby: `.rb`
- PHP: `.php`
- Swift: `.swift`
- Scala: `.scala`
- Clojure: `.clj`

**Конфигурационные файлы:**
- YAML: `.yaml`, `.yml`
- JSON: `.json`
- XML: `.xml`
- HTML: `.html`
- CSS: `.css`
- Shell: `.sh`

**Ограничения:**
- Максимальный размер файла: 10MB

## Вопрос: Что делать если индексация не находит новые документы?

**Ответ:**
Если после индексации документы не появляются в результатах поиска:

1. **Проверьте статистику**: Используйте команду `stats` чтобы убедиться, что документы добавлены в индекс
2. **Проверьте путь к БД**: Убедитесь, что вы используете один и тот же путь к базе данных в командах index и search (параметр --db-path)
3. **Проверьте формат файлов**: Убедитесь, что файлы имеют поддерживаемое расширение
4. **Проверьте размер файлов**: Файлы больше 10MB не индексируются
5. **Проверьте кодировку**: Файлы должны быть в UTF-8

## Вопрос: Как работает инкрементальная индексация?

**Ответ:**
Система использует инкрементальную индексацию - файлы переиндексируются только при изменении. Проверка осуществляется по хешу SHA-256:

1. При индексации вычисляется хеш содержимого файла
2. Если файл с таким хешем уже есть в индексе, он пропускается
3. Если хеш изменился, старая версия удаляется и файл индексируется заново

Это экономит время и ресурсы при повторной индексации директорий.

## Вопрос: Что такое chunk-size и overlap?

**Ответ:**

**Chunk-size (размер чанка)** - это размер фрагмента текста, на который разбивается документ. По умолчанию 512 символов. Правильный размер чанка важен для качества поиска:
- Слишком маленький чанк может не содержать достаточно контекста
- Слишком большой чанк может содержать разрозненную информацию

**Overlap (перекрытие)** - это размер перекрытия между соседними чанками. По умолчанию 50 символов. Перекрытие нужно чтобы:
- Не потерять информацию на границах чанков
- Сохранить контекст для предложений, разделенных границей чанка

Рекомендуемые значения:
- Для коротких документов: chunk-size=256, overlap=30
- Для обычных документов: chunk-size=512, overlap=50
- Для длинных документов: chunk-size=1024, overlap=100

## Вопрос: Как удалить документ из индекса?

**Ответ:**
Используйте команду `remove`:

```bash
./gradlew run --args="remove /путь/к/файлу.txt"
```

Это удалит документ и все связанные с ним чанки и эмбеддинги из базы данных.

## Вопрос: Как очистить весь индекс?

**Ответ:**
Используйте команду `clear`:

```bash
./gradlew run --args="clear"
```

**Внимание:** Эта операция удаляет ВСЕ документы, чанки и эмбеддинги из базы данных. Операция необратима!

## Вопрос: Ошибка при индексации больших файлов

**Ответ:**
Если вы получаете ошибку "File too large" при индексации файла:

1. **Проверьте размер**: Максимальный размер файла - 10MB
2. **Разбейте файл**: Разделите большой файл на несколько меньших
3. **Оптимизируйте содержимое**: Удалите дублирующуюся информацию

Ограничение установлено для предотвращения проблем с памятью и производительностью при генерации эмбеддингов.
