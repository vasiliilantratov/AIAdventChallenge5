# Weather MCP Server Integration

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å MCP (Model Context Protocol) —Å–µ—Ä–≤–µ—Ä–æ–º –ø–æ–≥–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥–µ –≤ –ª—é–±–æ–º –≥–æ—Ä–æ–¥–µ –º–∏—Ä–∞.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1. Weather Server (MCP Server)
–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ –º–æ–¥—É–ª–µ `weather-server/`. –≠—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π MCP-—Å–µ—Ä–≤–µ—Ä, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª JSON-RPC —á–µ—Ä–µ–∑ stdio, –∫–æ—Ç–æ—Ä—ã–π:
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `get_current_weather` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç WeatherAPI (https://www.weatherapi.com/) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ subprocess, –∑–∞–ø—É—Å–∫–∞–µ–º—ã–π –≥–ª–∞–≤–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### 2. MCP Client Integration
–í –≥–ª–∞–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω `McpClientManager`, –∫–æ—Ç–æ—Ä—ã–π:
- –ó–∞–ø—É—Å–∫–∞–µ—Ç weather server –∫–∞–∫ subprocess
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –Ω–µ–º—É —á–µ—Ä–µ–∑ stdin/stdout
- –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –í—ã–∑—ã–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–æ –∑–∞–ø—Ä–æ—Å—É AI
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã MCP –≤ —Ñ–æ—Ä–º–∞—Ç, –ø–æ–Ω–∏–º–∞–µ–º—ã–π Ollama

### 3. Chat Integration
–ß–∞—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ tool calling:
- Ollama –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
- –ö–æ–≥–¥–∞ AI —Ä–µ—à–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
  - –í—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —á–µ—Ä–µ–∑ MCP
  - –ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ AI
  - AI –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Weather Server Module
```
weather-server/
‚îú‚îÄ‚îÄ build.gradle.kts          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Gradle
‚îî‚îÄ‚îÄ src/main/kotlin/org/example/weather/
    ‚îú‚îÄ‚îÄ WeatherApiModels.kt   # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö WeatherAPI
    ‚îú‚îÄ‚îÄ WeatherApiClient.kt   # HTTP-–∫–ª–∏–µ–Ω—Ç –¥–ª—è WeatherAPI
    ‚îî‚îÄ‚îÄ WeatherServer.kt      # MCP —Å–µ—Ä–≤–µ—Ä (JSON-RPC over stdio)
```

### Main Application Changes
- `McpClientManager.kt` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ MCP –∫–ª–∏–µ–Ω—Ç–æ–º –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- `DomainModels.kt` - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ tool calls (ToolCall, ToolFunction, AnySerializer)
- `OllamaChatClient.kt` - –†–∞—Å—à–∏—Ä–µ–Ω –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ tools –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
- `AiDialogService.kt` - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ tool calls –≤ —Ü–∏–∫–ª–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- `Main.kt` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ MCP —Å–µ—Ä–≤–µ—Ä–æ–º

## API –∫–ª—é—á

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª—é—á WeatherAPI: `723a066898ce45aa97c180652251612`

–ö–ª—é—á –≤—Å—Ç—Ä–æ–µ–Ω –≤ –∫–æ–¥ —Å–µ—Ä–≤–µ—Ä–∞. –î–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–Ω–µ—Å—Ç–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### get_current_weather
–ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é –ø–æ–≥–æ–¥—É –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `city` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Moscow", "London", "New York")

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
JSON –æ–±—ä–µ–∫—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–≥–æ–¥–µ, –≤–∫–ª—é—á–∞—é—â–∏–π:
- –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ä–µ–≥–∏–æ–Ω, —Å—Ç—Ä–∞–Ω–∞, –º–µ—Å—Ç–Ω–æ–µ –≤—Ä–µ–º—è)
- –¢–µ–∫—É—â–∞—è –ø–æ–≥–æ–¥–∞:
  - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C –∏ ¬∞F)
  - –û—â—É—â–∞–µ–º–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
  - –£—Å–ª–æ–≤–∏—è –ø–æ–≥–æ–¥—ã (—Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ)
  - –°–∫–æ—Ä–æ—Å—Ç—å –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞
  - –í–ª–∞–∂–Ω–æ—Å—Ç—å
  - –û—Å–∞–¥–∫–∏
  - –û–±–ª–∞—á–Ω–æ—Å—Ç—å
  - –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ
  - –í–∏–¥–∏–º–æ—Å—Ç—å
  - –£–§-–∏–Ω–¥–µ–∫—Å
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–≥–æ–¥–µ

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
./gradlew run
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –°–æ–∑–¥–∞—Å—Ç distribution –¥–ª—è MCP Weather Server (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞)
2. –ó–∞–ø—É—Å—Ç–∏—Ç MCP Weather Server –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
3. –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ –Ω–µ–º—É —á–µ—Ä–µ–∑ stdin/stdout
4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
5. –ü–æ–ª—É—á–∏—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
6. –ë—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ –ø–æ–≥–æ–¥–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Weather Server

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
./test-weather-server.sh
```

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤—Ä—É—á–Ω—É—é:

```bash
# –°–æ–∑–¥–∞—Ç—å distribution
./gradlew :weather-server:installDist

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
weather-server/build/install/weather-server/bin/weather-server

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å JSON-RPC –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ stdin
```

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –æ –ø–æ–≥–æ–¥–µ:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ö–∞–∫–∞—è —Å–µ–π—á–∞—Å –ø–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–µ?
/end
```

AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ü–æ–π–º–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `get_current_weather`
2. –í—ã–∑–æ–≤–µ—Ç –µ–≥–æ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `city: "Moscow"`
3. –ü–æ–ª—É—á–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ
4. –°—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏ –≤—ã–≤–µ–¥–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç

–î—Ä—É–≥–∏–µ –ø—Ä–∏–º–µ—Ä—ã:
```
–ö–∞–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –õ–æ–Ω–¥–æ–Ω–µ?
–†–∞—Å—Å–∫–∞–∂–∏ –æ –ø–æ–≥–æ–¥–µ –≤ –ù—å—é-–ô–æ—Ä–∫–µ
–ß—Ç–æ —Å –ø–æ–≥–æ–¥–æ–π –≤ –¢–æ–∫–∏–æ?
–°—Ç–æ–∏—Ç –ª–∏ –±—Ä–∞—Ç—å –∑–æ–Ω—Ç –≤ –ü–∞—Ä–∏–∂–µ?
```

### –í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏

–ü—Ä–∏ –≤—ã–∑–æ–≤–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
üîß –ò–ò –≤—ã–∑—ã–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
  - get_current_weather —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏: {"city":"Moscow"}
  ‚úì –†–µ–∑—É–ª—å—Ç–∞—Ç: {"location":{"name":"Moscow",...
```

–ó–∞—Ç–µ–º AI –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –≤—ã–¥–∞—Å—Ç –ø–æ–Ω—è—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞

### MCP JSON-RPC over stdio

Weather server —Ä–µ–∞–ª–∏–∑—É–µ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π MCP –ø—Ä–æ—Ç–æ–∫–æ–ª —á–µ—Ä–µ–∑ JSON-RPC:

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
```json
Request: {"jsonrpc":"2.0","id":1,"method":"initialize","params":{...}}
Response: {"jsonrpc":"2.0","id":1,"result":{"protocolVersion":"2024-11-05",...}}
```

**–°–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:**
```json
Request: {"jsonrpc":"2.0","id":2,"method":"tools/list"}
Response: {"jsonrpc":"2.0","id":2,"result":{"tools":[...]}}
```

**–í—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞:**
```json
Request: {
  "jsonrpc":"2.0",
  "id":3,
  "method":"tools/call",
  "params":{
    "name":"get_current_weather",
    "arguments":{"city":"Moscow"}
  }
}
Response: {
  "jsonrpc":"2.0",
  "id":3,
  "result":{
    "content":[{"type":"text","text":"..."}]
  }
}
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Java 21+
- Gradle 8.x
- Ollama —Å –º–æ–¥–µ–ª—å—é, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–π tool calling (–Ω–∞–ø—Ä–∏–º–µ—Ä, llama3.1:8b)
- –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ WeatherAPI

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- Weather server –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –∑–∞–Ω–∏–º–∞–µ—Ç ~2-3 —Å–µ–∫—É–Ω–¥—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã (–Ω–µ –ø—Ä–æ–≥–Ω–æ–∑)
- –ù–∞–∑–≤–∞–Ω–∏—è –≥–æ—Ä–æ–¥–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—é
- WeatherAPI –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç—ã –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à plan)

## –û—Ç–ª–∞–¥–∫–∞

–õ–æ–≥–∏ MCP —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ stderr:
```
Weather MCP Server started
Received: {"jsonrpc":"2.0",...}
Sent: {"jsonrpc":"2.0",...}
```

–õ–æ–≥–∏ –∫–ª–∏–µ–Ω—Ç–∞ —Ç–∞–∫–∂–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ stderr:
```
Starting weather server: ./gradlew :weather-server:run
MCP Weather Server connected successfully. Available tools: [get_current_weather]
Sending: {"jsonrpc":"2.0",...}
Received: {"jsonrpc":"2.0",...}
```

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ weather server:

1. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ –æ—Ç–≤–µ—Ç –Ω–∞ `tools/list` –≤ `WeatherServer.kt`
2. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ `tools/call` 
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ API –º–µ—Ç–æ–¥—ã –≤ `WeatherApiClient.kt`

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ API

Weather server –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –¥—Ä—É–≥–∏—Ö API:
1. –ó–∞–º–µ–Ω–∏—Ç–µ `WeatherApiClient` –Ω–∞ –∫–ª–∏–µ–Ω—Ç –Ω—É–∂–Ω–æ–≥–æ API
2. –û–±–Ω–æ–≤–∏—Ç–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –≤ `WeatherApiModels.kt`
3. –û–±–Ω–æ–≤–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ `WeatherServer.kt`

## Troubleshooting

**–ü—Ä–æ–±–ª–µ–º–∞:** `Stream closed` –∏–ª–∏ `Failed to start weather server`

–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏:
- Distribution –Ω–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞
- –ü—Ä–æ—Ü–µ—Å—Å –Ω–µ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è
- –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞

–†–µ—à–µ–Ω–∏–µ:
```bash
# –°–æ–∑–¥–∞–π—Ç–µ distribution –≤—Ä—É—á–Ω—É—é
./gradlew :weather-server:installDist

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π
ls -la weather-server/build/install/weather-server/bin/weather-server
chmod +x weather-server/build/install/weather-server/bin/weather-server

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–µ—Ä–≤–µ—Ä
./test-weather-server.sh
```

**–ü—Ä–æ–±–ª–µ–º–∞:** Weather server –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Gradle —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Java 21+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `[Weather Server]` –≤ stderr

**–ü—Ä–æ–±–ª–µ–º–∞:** AI –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å Ollama –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç tool calling
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è (—Å–º. –ª–æ–≥–∏)
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –±–æ–ª–µ–µ —è–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–∏—Å–ø–æ–ª—å–∑—É–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–≥–æ–¥—ã –¥–ª—è –ú–æ—Å–∫–≤—ã")

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–æ–≥–æ–¥—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –∫–ª—é—á –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –≥–æ—Ä–æ–¥–∞ (–Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ stderr –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** `No response from server (connection closed)`
- –°–µ—Ä–≤–µ—Ä –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ `[Weather Server]`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

